\hypertarget{class_conv2d}{}\section{Conv2d$<$ T $>$ Class Template Reference}
\label{class_conv2d}\index{Conv2d$<$ T $>$@{Conv2d$<$ T $>$}}


Computes a 2-\/D convolution given 4-\/D input and filter tensors.  




{\ttfamily \#include $<$convolution.\+hpp$>$}



Inheritance diagram for Conv2d$<$ T $>$\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=151pt]{class_conv2d__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for Conv2d$<$ T $>$\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=151pt]{class_conv2d__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
typedef xt\+::xarray$<$ T $>$ \mbox{\hyperlink{class_conv2d_a8263e2f2c46243e39fbca5712603c0fd}{Matrix}}
\item 
typedef Matrix\+::shape\+\_\+type \mbox{\hyperlink{class_conv2d_a78480f9c798b598a0bda9eadb1731225}{Shape}}
\end{DoxyCompactItemize}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_conv2d_ae28c4831d44bdf769768f29b9892e5d2}{Conv2d}} ()=default
\begin{DoxyCompactList}\small\item\em Construct a new Conv 2d object. \end{DoxyCompactList}\item 
virtual \mbox{\hyperlink{class_conv2d_a78911057f811daadff49ec744f063e3c}{$\sim$\+Conv2d}} ()=default
\begin{DoxyCompactList}\small\item\em Destroy the Conv 2d object. \end{DoxyCompactList}\item 
\mbox{\hyperlink{class_conv2d_a5676e8e1db6826703489568ff32c1436}{Conv2d}} (size\+\_\+t in\+\_\+channels, size\+\_\+t out\+\_\+channels, size\+\_\+t kernel\+\_\+size=3, size\+\_\+t stride=1, size\+\_\+t padding=0)
\begin{DoxyCompactList}\small\item\em Construct a new Conv 2d$<$ T$>$\+:: Conv 2d object. \end{DoxyCompactList}\item 
virtual \mbox{\hyperlink{class_conv2d_a8263e2f2c46243e39fbca5712603c0fd}{Matrix}} \mbox{\hyperlink{class_conv2d_ab795f6a1cabcfedfb2fcb55c9389c2fe}{forward}} (const \mbox{\hyperlink{class_conv2d_a8263e2f2c46243e39fbca5712603c0fd}{Matrix}} \&in) override
\item 
virtual \mbox{\hyperlink{class_conv2d_a8263e2f2c46243e39fbca5712603c0fd}{Matrix}} \mbox{\hyperlink{class_conv2d_ab5a54c023efbc6206b8f4aa355e5faa9}{backward}} (const \mbox{\hyperlink{class_conv2d_a8263e2f2c46243e39fbca5712603c0fd}{Matrix}} \&dout) override
\item 
virtual size\+\_\+t \mbox{\hyperlink{class_conv2d_a6eeedff6c4d0864a4c3788e06e82a2e4}{get\+\_\+fan}} ()
\begin{DoxyCompactList}\small\item\em Get the fan object. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
size\+\_\+t \mbox{\hyperlink{class_conv2d_afdb638e506f642d24a8d22fb8c2a821a}{in\+\_\+channels\+\_\+}}
\item 
size\+\_\+t \mbox{\hyperlink{class_conv2d_a48b99a4dee42c4d4221eddedccceffba}{out\+\_\+channels\+\_\+}}
\item 
size\+\_\+t \mbox{\hyperlink{class_conv2d_ad6447ab4000d593e8c4be9bb9c18f92b}{kernel\+\_\+size\+\_\+}}
\item 
size\+\_\+t \mbox{\hyperlink{class_conv2d_a8e548b8a5c0efaf494b819523951b558}{padding\+\_\+}}
\item 
size\+\_\+t \mbox{\hyperlink{class_conv2d_a95a69ad326bc6279247163d50f332b3d}{stride\+\_\+}}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\subsubsection*{template$<$typename T$>$\newline
class Conv2d$<$ T $>$}

Computes a 2-\/D convolution given 4-\/D input and filter tensors. 

Given an input tensor of shape \mbox{[}batch, in\+\_\+height, in\+\_\+width, in\+\_\+channels\mbox{]} and a filter / kernel tensor of shape \mbox{[}filter\+\_\+height, filter\+\_\+width, in\+\_\+channels, out\+\_\+channels\mbox{]}, this op performs the following\+:

Flattens the filter to a 2-\/D matrix with shape \mbox{[}filter\+\_\+height $\ast$ filter\+\_\+width $\ast$ in\+\_\+channels, output\+\_\+channels\mbox{]}. Extracts image patches from the input tensor to form a virtual tensor of shape \mbox{[}batch, out\+\_\+height, out\+\_\+width, filter\+\_\+height $\ast$ filter\+\_\+width $\ast$ in\+\_\+channels\mbox{]}. For each patch, right-\/multiplies the filter matrix and the image patch vector. 

\subsection{Member Typedef Documentation}
\mbox{\Hypertarget{class_conv2d_a8263e2f2c46243e39fbca5712603c0fd}\label{class_conv2d_a8263e2f2c46243e39fbca5712603c0fd}} 
\index{Conv2d$<$ T $>$@{Conv2d$<$ T $>$}!Matrix@{Matrix}}
\index{Matrix@{Matrix}!Conv2d$<$ T $>$@{Conv2d$<$ T $>$}}
\subsubsection{\texorpdfstring{Matrix}{Matrix}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
typedef xt\+::xarray$<$T$>$ \mbox{\hyperlink{class_conv2d}{Conv2d}}$<$ T $>$\+::\mbox{\hyperlink{class_conv2d_a8263e2f2c46243e39fbca5712603c0fd}{Matrix}}}

\mbox{\Hypertarget{class_conv2d_a78480f9c798b598a0bda9eadb1731225}\label{class_conv2d_a78480f9c798b598a0bda9eadb1731225}} 
\index{Conv2d$<$ T $>$@{Conv2d$<$ T $>$}!Shape@{Shape}}
\index{Shape@{Shape}!Conv2d$<$ T $>$@{Conv2d$<$ T $>$}}
\subsubsection{\texorpdfstring{Shape}{Shape}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
typedef Matrix\+::shape\+\_\+type \mbox{\hyperlink{class_conv2d}{Conv2d}}$<$ T $>$\+::\mbox{\hyperlink{class_conv2d_a78480f9c798b598a0bda9eadb1731225}{Shape}}}



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_conv2d_ae28c4831d44bdf769768f29b9892e5d2}\label{class_conv2d_ae28c4831d44bdf769768f29b9892e5d2}} 
\index{Conv2d$<$ T $>$@{Conv2d$<$ T $>$}!Conv2d@{Conv2d}}
\index{Conv2d@{Conv2d}!Conv2d$<$ T $>$@{Conv2d$<$ T $>$}}
\subsubsection{\texorpdfstring{Conv2d()}{Conv2d()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
\mbox{\hyperlink{class_conv2d}{Conv2d}}$<$ T $>$\+::\mbox{\hyperlink{class_conv2d}{Conv2d}} (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [default]}}



Construct a new Conv 2d object. 

\mbox{\Hypertarget{class_conv2d_a78911057f811daadff49ec744f063e3c}\label{class_conv2d_a78911057f811daadff49ec744f063e3c}} 
\index{Conv2d$<$ T $>$@{Conv2d$<$ T $>$}!````~Conv2d@{$\sim$Conv2d}}
\index{````~Conv2d@{$\sim$Conv2d}!Conv2d$<$ T $>$@{Conv2d$<$ T $>$}}
\subsubsection{\texorpdfstring{$\sim$Conv2d()}{~Conv2d()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
virtual \mbox{\hyperlink{class_conv2d}{Conv2d}}$<$ T $>$\+::$\sim$\mbox{\hyperlink{class_conv2d}{Conv2d}} (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [default]}}



Destroy the Conv 2d object. 

\mbox{\Hypertarget{class_conv2d_a5676e8e1db6826703489568ff32c1436}\label{class_conv2d_a5676e8e1db6826703489568ff32c1436}} 
\index{Conv2d$<$ T $>$@{Conv2d$<$ T $>$}!Conv2d@{Conv2d}}
\index{Conv2d@{Conv2d}!Conv2d$<$ T $>$@{Conv2d$<$ T $>$}}
\subsubsection{\texorpdfstring{Conv2d()}{Conv2d()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
\mbox{\hyperlink{class_conv2d}{Conv2d}}$<$ T $>$\+::\mbox{\hyperlink{class_conv2d}{Conv2d}} (\begin{DoxyParamCaption}\item[{size\+\_\+t}]{in\+\_\+channels,  }\item[{size\+\_\+t}]{out\+\_\+channels,  }\item[{size\+\_\+t}]{kernel\+\_\+size = {\ttfamily 3},  }\item[{size\+\_\+t}]{stride = {\ttfamily 1},  }\item[{size\+\_\+t}]{padding = {\ttfamily 0} }\end{DoxyParamCaption})}



Construct a new Conv 2d$<$ T$>$\+:: Conv 2d object. 


\begin{DoxyTemplParams}{Template Parameters}
{\em T} & \\
\hline
\end{DoxyTemplParams}

\begin{DoxyParams}{Parameters}
{\em in\+\_\+channels} & \+: It refers to the input image that needs to be convolved. It is required to be a Tensor with a shape such as \mbox{[}batch, in\+\_\+height, in\+\_\+width, in\+\_\+channels\mbox{]}. The specific meaning is \mbox{[}the number of pictures of a batch during training, the height of the picture, the width of the image, the number of image channels. \mbox{]}, note that this is a 4D Tensor, \\
\hline
{\em out\+\_\+channels} & \\
\hline
{\em kernel\+\_\+size} & size of the kernel \\
\hline
{\em stride} & The convolution step in each dimension of the image, this is a one-\/dimensional vector, with length 4 \\
\hline
{\em padding} & This value determines the different convolution methods \\
\hline
\end{DoxyParams}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{class_conv2d_ab5a54c023efbc6206b8f4aa355e5faa9}\label{class_conv2d_ab5a54c023efbc6206b8f4aa355e5faa9}} 
\index{Conv2d$<$ T $>$@{Conv2d$<$ T $>$}!backward@{backward}}
\index{backward@{backward}!Conv2d$<$ T $>$@{Conv2d$<$ T $>$}}
\subsubsection{\texorpdfstring{backward()}{backward()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
xt\+::xarray$<$ T $>$ \mbox{\hyperlink{class_conv2d}{Conv2d}}$<$ T $>$\+::backward (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_conv2d_a8263e2f2c46243e39fbca5712603c0fd}{Matrix}} \&}]{dout }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}


\begin{DoxyTemplParams}{Template Parameters}
{\em T} & \\
\hline
\end{DoxyTemplParams}

\begin{DoxyParams}{Parameters}
{\em dout} & \+: the backward input \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
xt\+::xarray$<$\+T$>$ 
\end{DoxyReturn}
only update if net is already set

Implements \mbox{\hyperlink{class_layer_ac4c13a3a85bfdd4d7d4d18669e3299fe}{Layer$<$ T $>$}}.

\mbox{\Hypertarget{class_conv2d_ab795f6a1cabcfedfb2fcb55c9389c2fe}\label{class_conv2d_ab795f6a1cabcfedfb2fcb55c9389c2fe}} 
\index{Conv2d$<$ T $>$@{Conv2d$<$ T $>$}!forward@{forward}}
\index{forward@{forward}!Conv2d$<$ T $>$@{Conv2d$<$ T $>$}}
\subsubsection{\texorpdfstring{forward()}{forward()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
xt\+::xarray$<$ T $>$ \mbox{\hyperlink{class_conv2d}{Conv2d}}$<$ T $>$\+::forward (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_conv2d_a8263e2f2c46243e39fbca5712603c0fd}{Matrix}} \&}]{in }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}


\begin{DoxyTemplParams}{Template Parameters}
{\em T} & \\
\hline
\end{DoxyTemplParams}

\begin{DoxyParams}{Parameters}
{\em in} & \+:input for the network \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
xt\+::xarray$<$\+T$>$ 
\end{DoxyReturn}
prepare for output

Implements \mbox{\hyperlink{class_layer_ab15b665c86974b1cf1d7ba4e309cb0e5}{Layer$<$ T $>$}}.

\mbox{\Hypertarget{class_conv2d_a6eeedff6c4d0864a4c3788e06e82a2e4}\label{class_conv2d_a6eeedff6c4d0864a4c3788e06e82a2e4}} 
\index{Conv2d$<$ T $>$@{Conv2d$<$ T $>$}!get\_fan@{get\_fan}}
\index{get\_fan@{get\_fan}!Conv2d$<$ T $>$@{Conv2d$<$ T $>$}}
\subsubsection{\texorpdfstring{get\_fan()}{get\_fan()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
size\+\_\+t \mbox{\hyperlink{class_conv2d}{Conv2d}}$<$ T $>$\+::get\+\_\+fan (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Get the fan object. 

get the fan of \mbox{\hyperlink{class_conv2d}{Conv2d}}

\begin{DoxyReturn}{Returns}
size\+\_\+t
\end{DoxyReturn}

\begin{DoxyTemplParams}{Template Parameters}
{\em T} & \\
\hline
\end{DoxyTemplParams}
\begin{DoxyReturn}{Returns}
size\+\_\+t 
\end{DoxyReturn}


Reimplemented from \mbox{\hyperlink{class_layer_a43681206a2ef690667c41423b6b6f20b}{Layer$<$ T $>$}}.



\subsection{Member Data Documentation}
\mbox{\Hypertarget{class_conv2d_afdb638e506f642d24a8d22fb8c2a821a}\label{class_conv2d_afdb638e506f642d24a8d22fb8c2a821a}} 
\index{Conv2d$<$ T $>$@{Conv2d$<$ T $>$}!in\_channels\_@{in\_channels\_}}
\index{in\_channels\_@{in\_channels\_}!Conv2d$<$ T $>$@{Conv2d$<$ T $>$}}
\subsubsection{\texorpdfstring{in\_channels\_}{in\_channels\_}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
size\+\_\+t \mbox{\hyperlink{class_conv2d}{Conv2d}}$<$ T $>$\+::in\+\_\+channels\+\_\+\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_conv2d_ad6447ab4000d593e8c4be9bb9c18f92b}\label{class_conv2d_ad6447ab4000d593e8c4be9bb9c18f92b}} 
\index{Conv2d$<$ T $>$@{Conv2d$<$ T $>$}!kernel\_size\_@{kernel\_size\_}}
\index{kernel\_size\_@{kernel\_size\_}!Conv2d$<$ T $>$@{Conv2d$<$ T $>$}}
\subsubsection{\texorpdfstring{kernel\_size\_}{kernel\_size\_}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
size\+\_\+t \mbox{\hyperlink{class_conv2d}{Conv2d}}$<$ T $>$\+::kernel\+\_\+size\+\_\+\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_conv2d_a48b99a4dee42c4d4221eddedccceffba}\label{class_conv2d_a48b99a4dee42c4d4221eddedccceffba}} 
\index{Conv2d$<$ T $>$@{Conv2d$<$ T $>$}!out\_channels\_@{out\_channels\_}}
\index{out\_channels\_@{out\_channels\_}!Conv2d$<$ T $>$@{Conv2d$<$ T $>$}}
\subsubsection{\texorpdfstring{out\_channels\_}{out\_channels\_}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
size\+\_\+t \mbox{\hyperlink{class_conv2d}{Conv2d}}$<$ T $>$\+::out\+\_\+channels\+\_\+\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_conv2d_a8e548b8a5c0efaf494b819523951b558}\label{class_conv2d_a8e548b8a5c0efaf494b819523951b558}} 
\index{Conv2d$<$ T $>$@{Conv2d$<$ T $>$}!padding\_@{padding\_}}
\index{padding\_@{padding\_}!Conv2d$<$ T $>$@{Conv2d$<$ T $>$}}
\subsubsection{\texorpdfstring{padding\_}{padding\_}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
size\+\_\+t \mbox{\hyperlink{class_conv2d}{Conv2d}}$<$ T $>$\+::padding\+\_\+\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_conv2d_a95a69ad326bc6279247163d50f332b3d}\label{class_conv2d_a95a69ad326bc6279247163d50f332b3d}} 
\index{Conv2d$<$ T $>$@{Conv2d$<$ T $>$}!stride\_@{stride\_}}
\index{stride\_@{stride\_}!Conv2d$<$ T $>$@{Conv2d$<$ T $>$}}
\subsubsection{\texorpdfstring{stride\_}{stride\_}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
size\+\_\+t \mbox{\hyperlink{class_conv2d}{Conv2d}}$<$ T $>$\+::stride\+\_\+\hspace{0.3cm}{\ttfamily [protected]}}



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
layer/\mbox{\hyperlink{convolution_8hpp}{convolution.\+hpp}}\item 
layer/\mbox{\hyperlink{convolution__impl_8hpp}{convolution\+\_\+impl.\+hpp}}\end{DoxyCompactItemize}
